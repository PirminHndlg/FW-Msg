{% load i18n %}
{% load base_filter %}
{% load bw_filters %}

{% with current_seminar=request.user.org|get_current_seminar %}
{% if current_seminar %}
<div class="dashboard-section">
    <div class="row g-3">
    {% for seminar in current_seminar %}
      <div class="col-12">
        <div class="card card-compact">
          <div class="card-body">
            <div class="row align-items-center g-3">
              <div class="col-12 col-md-8">
                <div class="d-flex align-items-start">
                  <div class="bg-primary-subtle rounded-circle p-2 p-md-3 me-2 me-md-3 flex-shrink-0">
                    <i class="bi bi-calendar-event text-primary d-block" style="font-size: 1.25rem;"></i>
                  </div>
                  <div class="flex-grow-1">
                    <h4 class="mb-2 fs-5 fs-md-4">{{ seminar.name }}</h4>
                    <p class="text-muted mb-0 small"><i class="bi bi-calendar-event me-1"></i>{{ seminar.seminar_start|date:'d.m.' }} - {{ seminar.seminar_end|date:'d.m.Y' }}</p>
                  </div>
                </div>
              </div>
              <div class="col-12 col-md-4 text-center text-md-end">
                <a href="{% url 'seminar_home' %}" class="btn btn-primary btn-lg w-100 w-md-auto">
                  <i class="bi bi-arrow-right-circle me-2"></i>
                  {% trans "Zum Seminar" %}
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
    </div>
</div>

{% if request.user.role in 'OTE' and request.user|get_bewerbers_of_interviewperson %}
<div class="dashboard-section">
    <div class="row g-3">
        <div class="col-12">
            <div class="d-flex align-items-center mb-3">
                <i class="bi bi-folder2-open text-primary me-2 fs-4"></i>
                <h5 class="mb-0 fw-bold">{% trans "Bewerbungen einsehen" %}</h5>
            </div>
            <div class="row row-cols-1 row-cols-md-2 g-3">
                {% for bewerber in request.user|get_bewerbers_of_interviewperson %}
                <div class="col">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-body position-relative">
                            <div class="d-flex align-items-center mb-2">
                                <div class="bg-gradient bg-primary-subtle rounded-circle p-2 me-3">
                                    <i class="bi bi-person-circle text-primary fs-4"></i>
                                </div>
                                <div>
                                    <h6 class="fw-semibold mb-0">{{ bewerber.user.first_name }} {{ bewerber.user.last_name }}</h6>
                                    <span class="text-muted small">{{ bewerber.user.email }}</span>
                                </div>
                            </div>
                            <hr>
                            <a href="{% url 'application_answer_download' bewerber.id %}"
                               class="btn btn-outline-primary w-100 d-flex align-items-center justify-content-center"
                               target="_blank"
                               style="transition: background 0.2s;">
                                <i class="bi bi-file-earmark-pdf fs-5 me-2"></i>
                                <span class="fw-semibold">{% trans "PDF herunterladen" %}</span>
                            </a>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col">
                    <div class="alert alert-info text-center mb-0">
                        {% trans "Keine Bewerbungen vorhanden." %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endif %}

{% endif %}
{% endwith %}
