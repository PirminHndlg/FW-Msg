{% load dokument_filter %}
{% load i18n %}

{% if dokument.get_document_type|starts_with:'image' %}
    <img onclick="showImgLarge(this)" 
            data-preview-src="{% url 'serve_dokument' dokument.id %}"
            class="card-img-top img-fluid cursor-pointer rounded-top-4"
            alt="{{ dokument.titel }}">
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% elif dokument.get_document_type|starts_with:'application/pdf' %}
    <a href="{% url 'serve_dokument' dokument.id %}" target="_blank" class="text-decoration-none">
        <img data-preview-src="{% url 'serve_dokument' dokument.id %}?img=True" 
                class="card-img-top img-fluid rounded-top-4"
                alt="PDF Vorschau">
    </a>
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% elif dokument.dokument.name|ends_with:'docx' or dokument.dokument.name|ends_with:'doc' or dokument.dokument.name|ends_with:'odt' %}
    <a href="{% url 'serve_dokument' dokument.id %}?download=True" class="text-decoration-none">
        <img data-preview-src="{% url 'serve_dokument' dokument.id %}?img=True" 
                class="card-img-top img-fluid rounded-top-4"
                alt="{{ dokument.get_document_suffix }} Vorschau">
    </a>
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% elif dokument.dokument.name|ends_with:'xls' or dokument.dokument.name|ends_with:'xlsx' %}
    <a href="{% url 'serve_dokument' dokument.id %}?download=True" class="text-decoration-none">
        <img data-preview-src="{% url 'serve_dokument' dokument.id %}?img=True" 
                class="card-img-top img-fluid rounded-top-4"
                alt="{{ dokument.get_document_suffix }} Vorschau">
    </a>
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% elif dokument.get_document_type|starts_with:'video' %}
    <a href="{% url 'serve_dokument' dokument.id %}" target="_blank" class="text-decoration-none">
        <div class="card-img-top position-relative bg-dark rounded-top-4" style="height: 200px; overflow: hidden;">
            <video class="w-100 h-100" style="object-fit: cover;" preload="metadata">
                <source data-preview-src="{% url 'serve_dokument' dokument.id %}" type="{{ dokument.get_document_type }}">
                {% trans 'Ihr Browser unterst√ºtzt das Video-Tag nicht.' %}
            </video>
            <div class="position-absolute top-50 start-50 translate-middle">
                <i class="bi bi-play-circle-fill text-white" style="font-size: 3rem; opacity: 0.8;"></i>
            </div>
        </div>
    </a>
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% elif dokument.link %}
    <a href="{{ dokument.link }}" target="_blank" class="text-decoration-none">
        <div class="card-img-top d-flex flex-column align-items-center justify-content-center bg-light rounded-top-4" 
             style="height: 120px; background-image: url('{{ dokument.link|get_favicon_url }}'); background-size: contain; background-position: center; background-repeat: no-repeat;">
            <i class="bi bi-link fa-3x text-secondary"></i>
            <p class="text-muted small">{{ dokument.link|get_short_link }}</p>
        </div>
    </a>
    <hr class="m-0">
{% elif dokument.dokument %}
    <a href="{% url 'serve_dokument' dokument.id %}?download=true" class="text-decoration-none">
        <div class="card-img-top d-flex align-items-center justify-content-center bg-light rounded-top-4" style="height: 80px;">
            <i class="bi bi-file-earmark fa-3x text-secondary"></i>
        </div>
    </a>
    <span class="badge bg-dark bg-opacity-25">{{ dokument.get_document_suffix }}</span>
{% endif %} 