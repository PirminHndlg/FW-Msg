{% load i18n %}
{% load dokument_filter %}

<div class="col-sm-6 col-md-4 col-lg-3" id="dokument-{{ dokument.id }}"
    data-id="{{ dokument.id }}"
    data-titel="{{ dokument.titel|default:'' }}"
    data-beschreibung="{{ dokument.beschreibung|default:'' }}"
    data-date_created="{{ dokument.date_created }}"
    data-link="{{ dokument.link|default:'' }}"
    data-dokument="{{ dokument|get_document_name|default:'' }}"
    data-folder_id="{{ structure.ordner.id }}"
    data-folder_name="{{ structure.ordner }}">
    {% for person_cluster in dokument.darf_bearbeiten.all %}
        <input type="hidden" name="darf_bearbeiten" value="{{ person_cluster.id }}">
    {% endfor %}
    <div class="card rounded-4 h-100 hover-shadow">
        {% include "components/document_preview.html" %}
        
        <div class="card-body pt-2">
            {% with dokument_name=dokument|get_document_name %}
                <h6 class="card-title fw-bold mb-1">{{ dokument.titel|default:dokument_name }}</h6>

                {% include "components/document_description.html" %}

                {% if dokument.link %}
                    <p class="card-text text-muted small">
                        <a href="{{ dokument.link }}" target="_blank" class="text-decoration-none">{{ dokument.link }}</a>
                    </p>
                {% endif %}

                {% if dokument.dokument %}
                <div class="d-flex justify-content-between align-items-center">
                    <a href="{% url 'serve_dokument' dokument.id %}?download=true" 
                    class="btn btn-outline-primary btn-sm rounded-4 text-decoration-none"
                    download>
                        <i class="bi bi-download"></i> {% trans "Download" %}
                    </a>
                </div>
                {% endif %}
            </div>

            {% if user.person_cluster.view == 'O' or user.customuser.person_cluster in dokument.darf_bearbeiten %}
            <div class="card-footer">
                <button onclick="removeDokument({{ dokument.id }}, '{{ dokument.titel|default:dokument_name }}', '{% url 'remove_dokument' %}')"
                        class="btn btn-outline-danger btn-sm rounded-4">
                    <i class="bi bi-trash"></i>
                </button>

                <button class="btn btn-sm rounded-4" onclick="editDokument({{ dokument.id }})">
                    <i class="bi bi-pencil"></i>
                </button>
            </div>
            {% endif %}
        {% endwith %}
    </div>
</div> 