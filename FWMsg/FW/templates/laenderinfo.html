{% extends 'baseFw.html' %}
{% load static %}
{% load i18n %}

{% block head %}
  <style>
    .card-hover {
      transition: transform 0.2s;
    }
    .card-hover:hover {
      transform: translateY(-2px);
    }
    .info-icon {
      font-size: 1.2rem;
      margin-right: 0.5rem;
    }
    .contact-info {
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
    }
    .contact-info:last-child {
      margin-bottom: 0;
    }
    .contact-info i {
      min-width: 1.5rem;
    }
    .section-title {
      margin: 1.5rem 0 1rem;
    }
    .section-title:first-child {
      margin-top: 0;
    }
  </style>
{% endblock %}

{% block content %}
  <!-- Header Card -->
  <div class="card rounded-4">
    <!-- Country Header -->
    <div class="card-header rounded-4 d-flex align-items-center flex-wrap gap-3">
      <h3 class="mb-0 me-auto">{% trans 'Länderinfo' %}</h3>
      {% if freiwilliger.einsatzland2 %}
        <div class="d-flex align-items-center">
          <span class="fi fi-{{ freiwilliger.einsatzland2.code|lower }} me-3" style="width: 3rem; height: auto; font-size: 2rem;"></span>
          <div>
            <div class="fw-bold">{{ freiwilliger.einsatzland2.name|default:'' }}</div>
            <div class="d-flex gap-2 text-muted small">
              {% if freiwilliger.einsatzstelle2 %}
                <span><i class="bi bi-buildings me-1"></i>{{ freiwilliger.einsatzstelle2.name|default:'' }}</span>
              {% endif %}
            </div>
          </div>
        </div>
      {% endif %}
    </div>

    <div class="card-body">
        {# Planned Dates Section #}
        <div class="col-12 p-1 m-0 d-flex flex-wrap gap-4 text-muted">
        {% if freiwilliger.start_real %}
            <p class="m-0 p-0">{% trans 'Start real' %}: {{ freiwilliger.start_real|date:'d.m.Y' }}</p>
        {% elif freiwilliger.start_geplant %}
            <p class="m-0 p-0">{% trans 'Geplanter Start' %}: {{ freiwilliger.start_geplant|date:'d.m.Y' }}</p>
        {% endif %}

        {% if freiwilliger.ende_real %}
            <p class="m-0 p-0">{% trans 'Ende real' %}: {{ freiwilliger.ende_real|date:'d.m.Y' }}</p>
        {% elif freiwilliger.ende_geplant %}
            <p class="m-0 p-0">{% trans 'Geplantes Ende' %}: {{ freiwilliger.ende_geplant|date:'d.m.Y' }}</p>
          {% endif %}
        </div>
    </div>
  </div>

  {# Organization Section #}
  {% include 'components/info_section.html' with section_title=_('Entsendende Organisation') cards=org_cards %}

  {# Country Information Section #}
  {% if freiwilliger.einsatzland2 %}
    {% include 'components/info_section.html' with section_title=_('Länderinformationen')|add:' '|add:freiwilliger.einsatzland2.name cards=country_cards %}
  {% endif %}

  {# Assignment Location Information #}
  {% if freiwilliger.einsatzstelle2 %}
    {% include 'components/info_section.html' with section_title=_('Informationen Einsatzstelle')|add:' '|add:freiwilliger.einsatzstelle2.name cards=location_cards %}
    {% include 'components/info_section.html' with section_title=_('Generelle Informationen') cards=general_cards %}
  {% endif %}
{% endblock %}

{% block scripts %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Initialize all tooltips
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
      })
    })
  </script>
{% endblock %}
