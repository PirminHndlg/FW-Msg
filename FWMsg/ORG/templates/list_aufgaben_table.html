{% extends "baseOrg.html" %}
{% load static %}
{% load i18n %}
{% block title %}{% trans "Aufgaben" %}{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/list_aufgaben.css' %}">
<style>
    /* Essential styles that Bootstrap doesn't cover */
    .table-responsive {
        max-height: calc(100vh - 200px);
        overflow: auto;
    }

    /* Sticky first column */
    .table th:first-child,
    .table td:first-child {
        position: sticky;
        left: 0;
        background-color: var(--bs-body-bg);
        z-index: 2;
    }

    /* Sticky header */
    .table thead th {
        position: sticky;
        top: 0;
        background-color: var(--bs-body-bg);
        z-index: 1;
    }

    /* Extra z-index for the corner cell */
    .table thead th:first-child {
        z-index: 3;
    }

    /* Simplified tooltip styles */
    [data-tooltip] {
        position: relative;
    }

    [data-tooltip]::before {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        padding: 0.25rem 0.5rem;
        background-color: var(--bs-dark);
        color: var(--bs-white);
        font-size: 0.875rem;
        border-radius: var(--bs-border-radius-sm);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.2s, visibility 0.2s;
        transition-delay: 0.4s;
    }

    /* Special tooltip positioning for add-all button */
    .data-tooltip-bottom[data-tooltip]::before {
        bottom: auto;
        top: 100%;
        margin-top: 5px;
    }

    [data-tooltip]:hover::before {
        opacity: 1;
        visibility: visible;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex gap-2 justify-content-between align-items-center flex-wrap">
    <h2>{% trans "Aufgaben√ºbersicht" %}</h2>
    {% include "components/task_legend.html" %}
</div>

<div class="card rounded-4">
    {% include "components/task_filter.html" %}
    <div class="card-body p-2">
        {% include "components/task_table.html" %}
    </div>
</div>

{% include "components/task_country_modal.html" with countries=countries %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const scrollToElement = document.getElementById('scroll-to');
        if (scrollToElement) {
            scrollToElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    });

    function setTaskId(taskId, taskName) {
        document.getElementById('taskIdInput').value = taskId;
        document.getElementById('task_name').innerHTML = taskName;
    }
</script>
{% endblock %}
